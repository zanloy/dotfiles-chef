image: ruby:2.6.5
tasks:
  install_build_deps:
    command: |
      apt update
      apt install --yes build-essential
  install_gems:
    command: gem install bundler
  install:
    dependencies:
      - install_build_deps
      - install_gems
    input_paths:
      - Gemfile
      - Gemfile.lock
      - install.sh
    command: ./install.sh
  run:
    cache: false
    dependencies:
      - install
    mount_paths:
      - .
    command: ./run.sh
