image: ubuntu:bionic
tasks:
  install_build_deps:
    command: |
      apt update
      DEBIAN_FRONTEND=noninteractive apt install --yes build-essential chef chef-zero ruby ruby-dev ruby-bundler sudo
  install:
    dependencies:
      - install_build_deps
    input_paths:
      - Gemfile
      - Gemfile.lock
      - install.sh
    command: ./install.sh
  run:
    cache: false
    dependencies:
      - install
    mount_paths:
      - .
    command: ./run.sh
